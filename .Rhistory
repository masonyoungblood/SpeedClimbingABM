geom_point(data = grid) +
theme_void()
ggplot(route_plot, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1)) +
theme_void()
ggplot(route_plot, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red") +
theme_void()
ggplot(route_plot, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17)) +
theme_void()
ggplot(route_plot, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = 3) +
theme_void()
ggplot(route_plot, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(3, 20), 5)) +
theme_void()
ggplot(route_plot, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(3, 20), 5)) +
xlim(min(grid$x-0.2), max(grid$x-0.2)) + ylim(min(grid$y-0.2), max(grid$y-0.2))
ggplot(route_plot, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(3, 20), 5)) +
xlim(min(grid$x-0.2), max(grid$x-0.2)) + ylim(min(grid$y-0.2), max(grid$y-0.2)) +
theme_void()
max(grid$y)
ggplot(route_plot, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(3, 20), 5)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
load("hpcc_output/posteriors_w.RData")
load("hpcc_output/priors_w.RData")
barplot_data <- table((20-c(lengths(routes_norm_m_common), lengths(routes_norm_w_common[1:4000]))), as.factor(c(rep(0, length(routes_norm_m_common)), rep(1, length(routes_norm_w_common[1:4000])))))
routes_norm_m_best <- lapply(1:length(posteriors_m$norm), function(x){posteriors_m$norm[[x]]$beta[[which.min(posteriors_m$norm[[x]]$current_record)]]})
routes_norm_m_common <- lapply(1:length(posteriors_m$norm), function(x){as.numeric(strsplit(names(sort(table(sapply(1:length(posteriors_m$norm[[x]]$beta), function(y){paste0(which(posteriors_m$norm[[x]]$beta[[y]]), collapse = " ")})), decreasing = TRUE)[1]), " ")[[1]])})
routes_norm_w_best <- lapply(1:length(posteriors_w$norm), function(x){posteriors_w$norm[[x]]$beta[[which.min(posteriors_w$norm[[x]]$current_record)]]})
routes_norm_w_common <- lapply(1:length(posteriors_w$norm), function(x){as.numeric(strsplit(names(sort(table(sapply(1:length(posteriors_w$norm[[x]]$beta), function(y){paste0(which(posteriors_w$norm[[x]]$beta[[y]]), collapse = " ")})), decreasing = TRUE)[1]), " ")[[1]])})
barplot_data <- table((20-c(lengths(routes_norm_m_common), lengths(routes_norm_w_common[1:4000]))), as.factor(c(rep(0, length(routes_norm_m_common)), rep(1, length(routes_norm_w_common[1:4000])))))
barplot_data
table((20-c(lengths(routes_norm_m_common), lengths(routes_norm_w_common[1:4000]))
)
table((20-c(lengths(routes_norm_m_common), lengths(routes_norm_w_common[1:4000])
table((20-c(lengths(routes_norm_m_common), lengths(routes_norm_w_common[1:4000]))
()
)
()
table()
table((20-c(lengths(routes_norm_m_common)))
)
table((20-c(lengths(routes_norm_m_common))))
as.data.frame(table((20-c(lengths(routes_norm_m_common)))))
rbind(as.data.frame(table((20-c(lengths(routes_norm_m_common))))), as.data.frame(table((20-c(lengths(routes_norm_w_common))))))
barplot_data <- rbind(as.data.frame(table((20-c(lengths(routes_norm_m_common))))), as.data.frame(table((20-c(lengths(routes_norm_w_common))))))
table((20-c(lengths(routes_norm_m_common))))
max((20-c(lengths(routes_norm_m_common))))
barplot_data$id <- c(rep(0, max((20-c(lengths(routes_norm_m_common))))), rep(0, max((20-c(lengths(routes_norm_w_common))))))
barplot_data <- rbind(as.data.frame(table((20-c(lengths(routes_norm_m_common))))), as.data.frame(table((20-c(lengths(routes_norm_w_common))))))
barplot_data$id <- c(rep(0, max((20-c(lengths(routes_norm_m_common))))), rep(1, max((20-c(lengths(routes_norm_w_common))))))
c(rep(0, max((20-c(lengths(routes_norm_m_common))))), rep(1, max((20-c(lengths(routes_norm_w_common))))))
barplot_data$id <- c(rep(0, max((20-c(lengths(routes_norm_m_common))))+1), rep(1, max((20-c(lengths(routes_norm_w_common))))+1))
barplot_data <- rbind(as.data.frame(table((20-c(lengths(routes_norm_m_common))))), as.data.frame(table((20-c(lengths(routes_norm_w_common))))))
barplot_data$id <- c(rep(0, max((20-c(lengths(routes_norm_m_common))))+1), rep(1, max((20-c(lengths(routes_norm_w_common))))+1))
barplot_data
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq))
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq)) + geom_bar()
?geom_bar
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq)) + geom_bar(stat = NULL)
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq)) + geom_bar(stat = "identity")
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq)) + geom_bar(stat = "identity") + facet_wrap(~id)
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq)) + geom_bar(stat = "identity") + facet_wrap(~id) + theme_linedraw()
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq)) + geom_bar(stat = "identity") + facet_wrap(~id) + theme_linedraw() + theme(legend.position = "none")
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
facet_wrap(~id) +
theme_linedraw(base_size = 9) +
theme(strip.text.x = element_blank(), legend.position = "none")
ggplot(barplot_data, aes(fill = id, x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
facet_wrap(~id) +
scale_fill_manual(values = c("red", "blue")) +
theme_linedraw(base_size = 9) +
theme(strip.text.x = element_blank(), legend.position = "none")
ggplot(barplot_data, aes(fill = as.factor(id), x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
facet_wrap(~id) +
scale_fill_manual(values = c("red", "blue")) +
theme_linedraw(base_size = 9) +
theme(strip.text.x = element_blank(), legend.position = "none")
ggplot(barplot_data, aes(fill = as.factor(id), x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
facet_wrap(~id) +
scale_fill_manual(values = c("red", "blue")) +
theme_linedraw(base_size = 9) +
xlab("# Holds Skipped") + ylab(NULL) +
theme(strip.text.x = element_blank(), legend.position = "none")
barplot <- ggplot(barplot_data, aes(fill = as.factor(id), x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
facet_wrap(~id) +
scale_fill_manual(values = c("red", "blue")) +
theme_linedraw(base_size = 9) +
xlab("# Holds Skipped") + ylab(NULL) +
theme(strip.text.x = element_blank(), legend.position = "none")
route_plot_m <- do.call(rbind, lapply(1:length(routes_norm_m_common), function(x){
temp <- grid[routes_norm_m_common[[x]], ]
temp$id <- x
temp
}))
route_plot_m <- ggplot(route_plot_m, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(3, 20), 5)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
route_plot_w <- do.call(rbind, lapply(1:length(routes_norm_w_common), function(x){
temp <- grid[routes_norm_w_common[[x]], ]
temp$id <- x
temp
}))
route_plot_w <- ggplot(route_plot_w, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "blue", shape = c(rep(19, 20), 17), size = c(rep(3, 20), 5)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
barplot_data <- rbind(as.data.frame(table((20-c(lengths(routes_norm_m_common))))), as.data.frame(table((20-c(lengths(routes_norm_w_common))))))
barplot_data$id <- c(rep(0, max((20-c(lengths(routes_norm_m_common))))+1), rep(1, max((20-c(lengths(routes_norm_w_common))))+1))
barplot <- ggplot(barplot_data, aes(fill = as.factor(id), x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
facet_wrap(~id) +
scale_fill_manual(values = c("red", "blue")) +
theme_linedraw(base_size = 9) +
xlab("# Holds Skipped") + ylab(NULL) +
theme(strip.text.x = element_blank(), legend.position = "none")
temp_prior <- do.call(rbind, lapply(1:10000, function(x){
temp <- density(priors_m[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "a", b = x)
}))
temp_posterior_a <- do.call(rbind, lapply(1:2000, function(x){
temp <- density(posteriors_m$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "b", b = x)
}))
temp_posterior_b <- do.call(rbind, lapply(1:2000, function(x){
temp <- density(posteriors_m$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "c", b = x)
}))
temp_observed <- data.frame(x = density(data$time[which(data$gender == "M" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$x,
y = density(data$time[which(data$gender == "M" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$y,
a = "d", b = 1)
temp_prior <- do.call(rbind, lapply(1:500, function(x){
temp <- density(priors_m[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "a", b = x)
}))
temp_posterior_a <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_m$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "b", b = x)
}))
temp_posterior_b <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_m$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "c", b = x)
}))
temp_observed <- data.frame(x = density(data$time[which(data$gender == "M" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$x,
y = density(data$time[which(data$gender == "M" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$y,
a = "d", b = 1)
curve_data_m <- rbind(temp_prior, temp_posterior_a, temp_posterior_b, temp_observed)
rm(list = c("temp_prior", "temp_posterior_a", "temp_posterior_b", "temp_observed"))
posterior_m <- ggplot(curve_data_m, aes(x = x, y = y, group = paste0(a, b), color = as.factor(a))) +
geom_line() +
scale_color_manual(values = c(scales::alpha("gray88", 1), scales::alpha("white", 0.02), scales::alpha("red", 0.002), "black")) +
theme_linedraw(base_size = 9) + theme(legend.position = "none") + xlab("Climbing Times (s)") + ylab(NULL)
temp_prior <- do.call(rbind, lapply(1:500, function(x){
temp <- density(priors_w[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "a", b = x)
}))
temp_posterior_a <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_w$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "b", b = x)
}))
temp_posterior_b <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_w$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "c", b = x)
}))
temp_observed <- data.frame(x = density(data$time[which(data$gender == "W" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$x,
y = density(data$time[which(data$gender == "W" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$y,
a = "d", b = 1)
curve_data_w <- rbind(temp_prior, temp_posterior_a, temp_posterior_b, temp_observed)
rm(list = c("temp_prior", "temp_posterior_a", "temp_posterior_b", "temp_observed"))
posterior_w <- ggplot(curve_data_w, aes(x = x, y = y, group = paste0(a, b), color = as.factor(a))) +
geom_line() +
scale_color_manual(values = c(scales::alpha("gray88", 1), scales::alpha("white", 0.02), scales::alpha("blue", 0.002), "black")) +
theme_linedraw(base_size = 9) + theme(legend.position = "none") + xlab("Climbing Times (s)") + ylab(NULL)
plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot, nrow = 2, rel_heights = c(2, 1))
plot_a_b
plot_a_b <- plot_grid(plot_a, barplot, nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_a_b
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
plot_c
plot_c
route_plot_m <- do.call(rbind, lapply(1:length(routes_norm_m_common), function(x){
temp <- grid[c(routes_norm_m_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_m <- ggplot(route_plot_m, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(3, 20), 5)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
route_plot_w <- do.call(rbind, lapply(1:length(routes_norm_w_common), function(x){
temp <- grid[c(routes_norm_w_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_w <- ggplot(route_plot_w, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "blue", shape = c(rep(19, 20), 17), size = c(rep(3, 20), 5)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
plot_c
posterior_bizniz <- plot_grid(plot_a_b, plot_c, nrow = 1, labels(c("", "C")))
posterior_bizniz <- plot_grid(plot_a_b, plot_c, nrow = 1, labels(c("", "C"))
)
posterior_bizniz <- plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"))
posterior_bizniz
png("posterior_bizniz.png", width = 5, height = 4, units = "in", res = 300)
posterior_bizniz <- plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
png("posterior_bizniz.png", width = 5, height = 4, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
route_plot_m <- do.call(rbind, lapply(1:length(routes_norm_m_common), function(x){
temp <- grid[c(routes_norm_m_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_m <- ggplot(route_plot_m, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(1.5, 20), 3)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
route_plot_w <- do.call(rbind, lapply(1:length(routes_norm_w_common), function(x){
temp <- grid[c(routes_norm_w_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_w <- ggplot(route_plot_w, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "blue", shape = c(rep(19, 20), 17), size = c(rep(1.5, 20), 3)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
png("posterior_bizniz.png", width = 6, height = 4, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(3, 1))
dev.off()
route_plot_m <- do.call(rbind, lapply(1:length(routes_norm_m_common), function(x){
temp <- grid[c(routes_norm_m_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_m <- ggplot(route_plot_m, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
route_plot_w <- do.call(rbind, lapply(1:length(routes_norm_w_common), function(x){
temp <- grid[c(routes_norm_w_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_w <- ggplot(route_plot_w, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "blue", shape = c(rep(19, 20), 17)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot, nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
png("posterior_bizniz.png", width = 6, height = 4, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2.5, 1))
dev.off()
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2.5, 1))
dev.off()
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2.2, 1))
dev.off()
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
temp_prior <- do.call(rbind, lapply(1:500, function(x){
temp <- density(priors_m[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "a", b = x)
}))
temp_posterior_a <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_m$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "b", b = x)
}))
temp_posterior_b <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_m$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "c", b = x)
}))
temp_observed <- data.frame(x = density(data$time[which(data$gender == "M" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$x,
y = density(data$time[which(data$gender == "M" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$y,
a = "d", b = 1)
curve_data_m <- rbind(temp_prior, temp_posterior_a, temp_posterior_b, temp_observed)
rm(list = c("temp_prior", "temp_posterior_a", "temp_posterior_b", "temp_observed"))
posterior_m <- ggplot(curve_data_m, aes(x = x, y = y, group = paste0(a, b), color = as.factor(a))) +
geom_line() +
scale_color_manual(values = c(scales::alpha("gray88", 1), scales::alpha("white", 0.02), scales::alpha("red", 0.002), "black")) +
theme_linedraw(base_size = 9) + theme(legend.position = "none") + xlab("Climbing Times (s)") + ylab(NULL) +
scale_y_continuous(labels = scales::number_format(accuracy = 0.01))
temp_prior <- do.call(rbind, lapply(1:500, function(x){
temp <- density(priors_w[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "a", b = x)
}))
temp_posterior_a <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_w$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "b", b = x)
}))
temp_posterior_b <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_w$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "c", b = x)
}))
temp_observed <- data.frame(x = density(data$time[which(data$gender == "W" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$x,
y = density(data$time[which(data$gender == "W" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$y,
a = "d", b = 1)
curve_data_w <- rbind(temp_prior, temp_posterior_a, temp_posterior_b, temp_observed)
rm(list = c("temp_prior", "temp_posterior_a", "temp_posterior_b", "temp_observed"))
posterior_w <- ggplot(curve_data_w, aes(x = x, y = y, group = paste0(a, b), color = as.factor(a))) +
geom_line() +
scale_color_manual(values = c(scales::alpha("gray88", 1), scales::alpha("white", 0.02), scales::alpha("blue", 0.002), "black")) +
theme_linedraw(base_size = 9) + theme(legend.position = "none") + xlab("Climbing Times (s)") + ylab(NULL) +
scale_y_continuous(labels = scales::number_format(accuracy = 0.01))
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot, nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
route_plot_m <- do.call(rbind, lapply(1:length(routes_norm_m_common), function(x){
temp <- grid[c(routes_norm_m_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_m <- ggplot(route_plot_m, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(2, 20), 4)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
route_plot_w <- do.call(rbind, lapply(1:length(routes_norm_w_common), function(x){
temp <- grid[c(routes_norm_w_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_w <- ggplot(route_plot_w, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "blue", shape = c(rep(19, 20), 17), size = c(rep(2, 20), 4)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) + ylim(min(grid$y-0.2), max(grid$y+0.2)) +
theme_void()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot, nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
route_plot_m <- do.call(rbind, lapply(1:length(routes_norm_m_common), function(x){
temp <- grid[c(routes_norm_m_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_m <- ggplot(route_plot_m, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "red", shape = c(rep(19, 20), 17), size = c(rep(2, 20), 4)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) +
theme_void()
route_plot_w <- do.call(rbind, lapply(1:length(routes_norm_w_common), function(x){
temp <- grid[c(routes_norm_w_common[[x]], 21), ]
temp$id <- x
temp
}))
route_plot_w <- ggplot(route_plot_w, aes(x = jitter(x), y = jitter(y), group = as.factor(id))) +
geom_path(color = scales::alpha("black", 0.002)) +
geom_point(data = grid, aes(group = 1), color = "blue", shape = c(rep(19, 20), 17), size = c(rep(2, 20), 4)) +
xlim(min(grid$x-0.2), max(grid$x+0.2)) +
theme_void()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot, nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
barplot
barplot <- ggplot(barplot_data, aes(fill = as.factor(id), x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
facet_wrap(~id) +
scale_fill_manual(values = c("red", "blue")) +
theme_linedraw(base_size = 9) +
xlab("# Holds Skipped") + ylab(NULL) +
theme(strip.text.x = element_blank(), legend.position = "bottom")
barplot
barplot <- ggplot(barplot_data, aes(fill = as.factor(id), x = Var1, y = Freq)) +
geom_bar(stat = "identity") +
facet_wrap(~id) +
scale_fill_manual(values = c("red", "blue"), name = "", labels = c("Men", "Women")) +
theme_linedraw(base_size = 9) +
xlab("# Holds Skipped") + ylab(NULL) +
theme(strip.text.x = element_blank(), legend.position = "bottom")
barplot
barplot
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot, nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot + theme(legend.position = "none"), get_legend(barplot), nrow = 3, rel_heights = c(2, 1, 0.1), labels = c("A", "B", ""))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_c, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot + theme(legend.position = "none"), nrow = 3, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
plot_d <- plot_grid(plot_c,  get_legend(barplot), nrow = 2, rel_heights = c(1, 0.1))
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_d, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot + theme(legend.position = "none"), nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
plot_d <- plot_grid(plot_c,  get_legend(barplot), nrow = 2, rel_heights = c(1, 0.1))
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_d, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot + theme(legend.position = "none"), nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
plot_d <- plot_grid(plot_c,  get_legend(barplot), nrow = 2, rel_heights = c(1, 0.06))
png("posterior_bizniz.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_d, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot + theme(legend.position = "none"), nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
plot_d <- plot_grid(plot_c,  get_legend(barplot), nrow = 2, rel_heights = c(1, 0.06))
png("hpcc_output/posteriors.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_d, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
temp_prior <- do.call(rbind, lapply(1:500, function(x){
temp <- density(priors_m[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "a", b = x)
}))
temp_posterior_a <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_m$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "b", b = x)
}))
temp_posterior_b <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_m$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "c", b = x)
}))
temp_observed <- data.frame(x = density(data$time[which(data$gender == "M" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$x,
y = density(data$time[which(data$gender == "M" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$y,
a = "d", b = 1)
curve_data_m <- rbind(temp_prior, temp_posterior_a, temp_posterior_b, temp_observed)
rm(list = c("temp_prior", "temp_posterior_a", "temp_posterior_b", "temp_observed"))
posterior_m <- ggplot(curve_data_m, aes(x = x, y = y, group = paste0(a, b), color = as.factor(a))) +
geom_line() + xlim(0, 25) +
scale_color_manual(values = c(scales::alpha("gray88", 1), scales::alpha("white", 0.02), scales::alpha("red", 0.002), "black")) +
theme_linedraw(base_size = 9) + theme(legend.position = "none") + xlab("Climbing Times (s)") + ylab(NULL) +
scale_y_continuous(labels = scales::number_format(accuracy = 0.01))
temp_prior <- do.call(rbind, lapply(1:500, function(x){
temp <- density(priors_w[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "a", b = x)
}))
temp_posterior_a <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_w$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "b", b = x)
}))
temp_posterior_b <- do.call(rbind, lapply(1:500, function(x){
temp <- density(posteriors_w$norm[[x]]$current_record, bw = "SJ", kernel = "gaussian")
data.frame(x = temp$x, y = temp$y, a = "c", b = x)
}))
temp_observed <- data.frame(x = density(data$time[which(data$gender == "W" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$x,
y = density(data$time[which(data$gender == "W" & data$year == "2019")], bw = "SJ", kernel = "gaussian")$y,
a = "d", b = 1)
curve_data_w <- rbind(temp_prior, temp_posterior_a, temp_posterior_b, temp_observed)
rm(list = c("temp_prior", "temp_posterior_a", "temp_posterior_b", "temp_observed"))
posterior_w <- ggplot(curve_data_w, aes(x = x, y = y, group = paste0(a, b), color = as.factor(a))) +
geom_line() + xlim(0, 25) +
scale_color_manual(values = c(scales::alpha("gray88", 1), scales::alpha("white", 0.02), scales::alpha("blue", 0.002), "black")) +
theme_linedraw(base_size = 9) + theme(legend.position = "none") + xlab("Climbing Times (s)") + ylab(NULL) +
scale_y_continuous(labels = scales::number_format(accuracy = 0.01))
plot_a <- plot_grid(posterior_m, posterior_w, nrow = 2)
plot_a_b <- plot_grid(plot_a, barplot + theme(legend.position = "none"), nrow = 2, rel_heights = c(2, 1), labels = c("A", "B"))
plot_c <- plot_grid(route_plot_m, route_plot_w, nrow = 1)
plot_d <- plot_grid(plot_c,  get_legend(barplot), nrow = 2, rel_heights = c(1, 0.06))
png("hpcc_output/posteriors.png", width = 8, height = 6, units = "in", res = 300)
plot_grid(plot_a_b, plot_d, nrow = 1, labels = c("", "C"), rel_widths = c(2, 1))
dev.off()
