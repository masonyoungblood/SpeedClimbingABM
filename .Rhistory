#set working directory, load data, source code
setwd("/Users/masonyoungblood/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM")
load("analysis/data_and_output/03_best_params/priors_and_simulations.RData")
load("climbing_times/best_climbing_times.RData"); data <- best_climbing_times; rm(best_climbing_times)
grid <- read.csv("grid.csv")/1000
source("SpeedClimbingABM.R")
#convert posteriors to usable table format
posterior_predictions <- jsonlite::read_json("analysis/data_and_output/04_best_params_inference/posterior_predictions.json")
posterior_predictions <- do.call(rbind, lapply(1:length(posterior_predictions), function(x){unlist(posterior_predictions[[x]])}))
posterior_predictions <- do.call(cbind, lapply(1:13, function(x){posterior_predictions[, x]*sd(priors_and_simulations[[1]][, x]) + mean(priors_and_simulations[[1]][, x])}))
posterior_predictions <- as.data.frame(posterior_predictions)
colnames(posterior_predictions) <- c("innov_prob", "learn_prob", "n_top",
"improve_min_m", "improve_min_w",
"improve_rate_m", "improve_rate_w",
"innov_x_year", "innov_x_times", "innov_x_pop",
"learn_x_year", "learn_x_times", "learn_x_pop")
#prevent n_top from being < 0 or > 1
posterior_predictions$n_top[which(posterior_predictions$n_top < 0)] <- 0
posterior_predictions$n_top[which(posterior_predictions$n_top > 1)] <- 1
#get posteriors for athletic improvement for manuscript (not plotted)
quantile(posterior_predictions$improve_min_m, probs = c(0.025, 0.5, 0.975))
quantile(posterior_predictions$improve_min_w, probs = c(0.025, 0.5, 0.975))
quantile(posterior_predictions$improve_rate_m, probs = c(0.025, 0.5, 0.975))
quantile(posterior_predictions$improve_rate_w, probs = c(0.025, 0.5, 0.975))
#load libraries for plotting
library(ggplot2)
library(cowplot)
library(grid)
#create function for constructing plots
plot_constructor <- function(post, tol = 1000, xlim, bound = 0.001, two_axes = TRUE, xlabel = NULL, ylabel = NULL, xlabs = TRUE, ybuffer = 0.02, small = FALSE, font_size = 6, color){
post <- density(post, from = xlim[1], to = xlim[2], bw = "SJ", kernel = "gaussian")
plot_data <- data.frame(x = c(post$x), y = c(post$y))
if(length(which(post$y < bound) > 0)){plot_data$y[which(plot_data$y < bound)] <- NA}
temp <- ggplot(plot_data, aes(x, y)) + geom_line(aes(y = y), color = color) +
geom_segment(x = plot_data$x[which.max(plot_data$y)], xend = plot_data$x[which.max(plot_data$y)],
y = plot_data$y[which.max(plot_data$y)], yend = 0, color = color, linetype = "solid") +
xlim(xlim[1], xlim[2]) + xlab(xlabel) + ylab("Density") + theme_linedraw(base_size = font_size) +
scale_y_continuous(expand = c(0, 0), limits = c(0, max(plot_data$y, na.rm = TRUE) + max(plot_data$y, na.rm = TRUE)*ybuffer)) +
theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), text = element_text(family = "Avenir Next"))
if(small){
temp <- temp +
theme(axis.text.y = element_blank()) +
geom_vline(xintercept = 0, linetype = "dotted", size = 0.5) +
annotation_custom(
grob = textGrob(ylabel,
x = 0.01, y = 0.78,
hjust = 0,
gp = gpar(fontsize = 6, fontfamily = "Avenir Next"))
) +
ylab("Density")
}
if(!xlabs){
temp <- temp + theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.ticks.x = element_blank())
}
return(temp)
}
#construct subpanels for plots
bounds <- c(-5, 5)
innov_prob <- plot_constructor(posterior_predictions$innov_prob, xlim = c(0, 1), xlabel = "Innovation Probability", color = "red")
innov_x_times <- plot_constructor(posterior_predictions$innov_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "red")
innov_x_pop <- plot_constructor(posterior_predictions$innov_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Innovation", color = "red")
innov_x_year <- plot_constructor(posterior_predictions$innov_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "red")
learn_prob <- plot_constructor(posterior_predictions$learn_prob, xlim = c(0, 1), xlabel = "Copying Probability", color = "blue")
learn_x_times <- plot_constructor(posterior_predictions$learn_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "blue")
learn_x_pop <- plot_constructor(posterior_predictions$learn_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Copying", color = "blue")
learn_x_year <- plot_constructor(posterior_predictions$learn_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "blue")
#improve_rate_m <- plot_constructor(posterior_predictions$improve_rate_m, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Men)")
#improve_rate_w <- plot_constructor(posterior_predictions$improve_rate_w, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Women)")
#set theme for cowplot
theme_set(theme_cowplot(font_family = "Avenir Next"))
#combined and save panels
#png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
?setEPS
setEPS(); postscript("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", width = 7.2, height = 3, family = "Avenir Next")
setEPS(); postscript("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", width = 7.2, height = 3, family = "Avenir")
library(extrafont)
setEPS(); postscript("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", width = 7.2, height = 3, family = "Avenir Next")
#combined and save panels
#png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
setEPS(); postscript("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", width = 7.2, height = 3)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
#combined and save panels
#png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
setEPS(); postscript("analysis/data_and_output/05_posterior_processing/posterior_distributions.eps", width = 7.2, height = 3)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
font_import("Avenir Next")
library(systemfonts)
#combined and save panels
#png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
setEPS(); postscript("analysis/data_and_output/05_posterior_processing/posterior_distributions.eps", width = 7.2, height = 3)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
#combined and save panels
#png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
setEPS(); postscript("analysis/data_and_output/05_posterior_processing/posterior_distributions.eps", width = 7.2, height = 3, family = "Avenir Next")
library(export)
install.packages("export")
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, family = "Avenir Next"
)
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Avenir Next"
)
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Avenir Next", type = "EPS"
)
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Avenir", type = "EPS"
)
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Arial", type = "EPS"
)
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Helvetica", type = "EPS"
)
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Avenir Next", type = "EPS"
)
#combined and save panels
png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
#also save as eps
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Avenir Next", type = "EPS"
)
#also save as eps
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Palatino", type = "EPS"
)
#set working directory, load data, source code
setwd("/Users/masonyoungblood/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM")
load("analysis/data_and_output/03_best_params/priors_and_simulations.RData")
load("climbing_times/best_climbing_times.RData"); data <- best_climbing_times; rm(best_climbing_times)
grid <- read.csv("grid.csv")/1000
source("SpeedClimbingABM.R")
#convert posteriors to usable table format
posterior_predictions <- jsonlite::read_json("analysis/data_and_output/04_best_params_inference/posterior_predictions.json")
posterior_predictions <- do.call(rbind, lapply(1:length(posterior_predictions), function(x){unlist(posterior_predictions[[x]])}))
posterior_predictions <- do.call(cbind, lapply(1:13, function(x){posterior_predictions[, x]*sd(priors_and_simulations[[1]][, x]) + mean(priors_and_simulations[[1]][, x])}))
posterior_predictions <- as.data.frame(posterior_predictions)
colnames(posterior_predictions) <- c("innov_prob", "learn_prob", "n_top",
"improve_min_m", "improve_min_w",
"improve_rate_m", "improve_rate_w",
"innov_x_year", "innov_x_times", "innov_x_pop",
"learn_x_year", "learn_x_times", "learn_x_pop")
#prevent n_top from being < 0 or > 1
posterior_predictions$n_top[which(posterior_predictions$n_top < 0)] <- 0
posterior_predictions$n_top[which(posterior_predictions$n_top > 1)] <- 1
#get posteriors for athletic improvement for manuscript (not plotted)
quantile(posterior_predictions$improve_min_m, probs = c(0.025, 0.5, 0.975))
quantile(posterior_predictions$improve_min_w, probs = c(0.025, 0.5, 0.975))
quantile(posterior_predictions$improve_rate_m, probs = c(0.025, 0.5, 0.975))
quantile(posterior_predictions$improve_rate_w, probs = c(0.025, 0.5, 0.975))
#load libraries for plotting
library(ggplot2)
library(cowplot)
library(grid)
#create function for constructing plots
plot_constructor <- function(post, tol = 1000, xlim, bound = 0.001, two_axes = TRUE, xlabel = NULL, ylabel = NULL, xlabs = TRUE, ybuffer = 0.02, small = FALSE, font_size = 6, color){
post <- density(post, from = xlim[1], to = xlim[2], bw = "SJ", kernel = "gaussian")
plot_data <- data.frame(x = c(post$x), y = c(post$y))
if(length(which(post$y < bound) > 0)){plot_data$y[which(plot_data$y < bound)] <- NA}
temp <- ggplot(plot_data, aes(x, y)) + geom_line(aes(y = y), color = color) +
geom_segment(x = plot_data$x[which.max(plot_data$y)], xend = plot_data$x[which.max(plot_data$y)],
y = plot_data$y[which.max(plot_data$y)], yend = 0, color = color, linetype = "solid") +
xlim(xlim[1], xlim[2]) + xlab(xlabel) + ylab("Density") + theme_linedraw(base_size = font_size) +
scale_y_continuous(expand = c(0, 0), limits = c(0, max(plot_data$y, na.rm = TRUE) + max(plot_data$y, na.rm = TRUE)*ybuffer)) +
theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), text = element_text(family = "Avenir Next"))
if(small){
temp <- temp +
theme(axis.text.y = element_blank()) +
geom_vline(xintercept = 0, linetype = "dotted", size = 0.5) +
annotation_custom(
grob = textGrob(ylabel,
x = 0.01, y = 0.78,
hjust = 0,
gp = gpar(fontsize = 6, fontfamily = "Avenir Next"))
) +
ylab("Density")
}
if(!xlabs){
temp <- temp + theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.ticks.x = element_blank())
}
return(temp)
}
#construct subpanels for plots
bounds <- c(-5, 5)
innov_prob <- plot_constructor(posterior_predictions$innov_prob, xlim = c(0, 1), xlabel = "Innovation Probability", color = "red")
innov_x_times <- plot_constructor(posterior_predictions$innov_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "red")
innov_x_pop <- plot_constructor(posterior_predictions$innov_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Innovation", color = "red")
innov_x_year <- plot_constructor(posterior_predictions$innov_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "red")
learn_prob <- plot_constructor(posterior_predictions$learn_prob, xlim = c(0, 1), xlabel = "Copying Probability", color = "blue")
learn_x_times <- plot_constructor(posterior_predictions$learn_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "blue")
learn_x_pop <- plot_constructor(posterior_predictions$learn_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Copying", color = "blue")
learn_x_year <- plot_constructor(posterior_predictions$learn_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "blue")
#improve_rate_m <- plot_constructor(posterior_predictions$improve_rate_m, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Men)")
#improve_rate_w <- plot_constructor(posterior_predictions$improve_rate_w, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Women)")
#set theme for cowplot
theme_set(theme_cowplot(font_family = "Palatino"))
#combined and save panels
png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
#also save as eps
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, type = "EPS"
)
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#set theme for cowplot
theme_set(theme_cowplot(font_family = "Palatino"))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#set theme for cowplot
theme_set(theme_cowplot(font_family = "Palatino Medium"))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
?theme_cowplot
#set theme for cowplot
theme_set(theme_cowplot(font_family = "Times New Roman"))
#combined and save panels
png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
#load libraries for plotting
library(ggplot2)
library(cowplot)
library(grid)
#set font family
font = "Palatino"
#create function for constructing plots
plot_constructor <- function(post, tol = 1000, xlim, bound = 0.001, two_axes = TRUE, xlabel = NULL, ylabel = NULL, xlabs = TRUE, ybuffer = 0.02, small = FALSE, font_size = 6, color){
post <- density(post, from = xlim[1], to = xlim[2], bw = "SJ", kernel = "gaussian")
plot_data <- data.frame(x = c(post$x), y = c(post$y))
if(length(which(post$y < bound) > 0)){plot_data$y[which(plot_data$y < bound)] <- NA}
temp <- ggplot(plot_data, aes(x, y)) + geom_line(aes(y = y), color = color) +
geom_segment(x = plot_data$x[which.max(plot_data$y)], xend = plot_data$x[which.max(plot_data$y)],
y = plot_data$y[which.max(plot_data$y)], yend = 0, color = color, linetype = "solid") +
xlim(xlim[1], xlim[2]) + xlab(xlabel) + ylab("Density") + theme_linedraw(base_size = font_size) +
scale_y_continuous(expand = c(0, 0), limits = c(0, max(plot_data$y, na.rm = TRUE) + max(plot_data$y, na.rm = TRUE)*ybuffer)) +
theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), text = element_text(family = font))
if(small){
temp <- temp +
theme(axis.text.y = element_blank()) +
geom_vline(xintercept = 0, linetype = "dotted", size = 0.5) +
annotation_custom(
grob = textGrob(ylabel,
x = 0.01, y = 0.78,
hjust = 0,
gp = gpar(fontsize = 6, fontfamily = font))
) +
ylab("Density")
}
if(!xlabs){
temp <- temp + theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.ticks.x = element_blank())
}
return(temp)
}
#construct subpanels for plots
bounds <- c(-5, 5)
innov_prob <- plot_constructor(posterior_predictions$innov_prob, xlim = c(0, 1), xlabel = "Innovation Probability", color = "red")
innov_x_times <- plot_constructor(posterior_predictions$innov_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "red")
innov_x_pop <- plot_constructor(posterior_predictions$innov_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Innovation", color = "red")
innov_x_year <- plot_constructor(posterior_predictions$innov_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "red")
learn_prob <- plot_constructor(posterior_predictions$learn_prob, xlim = c(0, 1), xlabel = "Copying Probability", color = "blue")
learn_x_times <- plot_constructor(posterior_predictions$learn_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "blue")
learn_x_pop <- plot_constructor(posterior_predictions$learn_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Copying", color = "blue")
learn_x_year <- plot_constructor(posterior_predictions$learn_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "blue")
#improve_rate_m <- plot_constructor(posterior_predictions$improve_rate_m, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Men)")
#improve_rate_w <- plot_constructor(posterior_predictions$improve_rate_w, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Women)")
#set theme for cowplot
theme_set(theme_cowplot(font_family = font))
#combined and save panels
png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
#also save as eps
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = font, type = "EPS"
)
#load libraries for plotting
library(ggplot2)
library(cowplot)
library(grid)
#set font family
font = "Avenir Next Condensed"
#create function for constructing plots
plot_constructor <- function(post, tol = 1000, xlim, bound = 0.001, two_axes = TRUE, xlabel = NULL, ylabel = NULL, xlabs = TRUE, ybuffer = 0.02, small = FALSE, font_size = 6, color){
post <- density(post, from = xlim[1], to = xlim[2], bw = "SJ", kernel = "gaussian")
plot_data <- data.frame(x = c(post$x), y = c(post$y))
if(length(which(post$y < bound) > 0)){plot_data$y[which(plot_data$y < bound)] <- NA}
temp <- ggplot(plot_data, aes(x, y)) + geom_line(aes(y = y), color = color) +
geom_segment(x = plot_data$x[which.max(plot_data$y)], xend = plot_data$x[which.max(plot_data$y)],
y = plot_data$y[which.max(plot_data$y)], yend = 0, color = color, linetype = "solid") +
xlim(xlim[1], xlim[2]) + xlab(xlabel) + ylab("Density") + theme_linedraw(base_size = font_size) +
scale_y_continuous(expand = c(0, 0), limits = c(0, max(plot_data$y, na.rm = TRUE) + max(plot_data$y, na.rm = TRUE)*ybuffer)) +
theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), text = element_text(family = font))
if(small){
temp <- temp +
theme(axis.text.y = element_blank()) +
geom_vline(xintercept = 0, linetype = "dotted", size = 0.5) +
annotation_custom(
grob = textGrob(ylabel,
x = 0.01, y = 0.78,
hjust = 0,
gp = gpar(fontsize = 6, fontfamily = font))
) +
ylab("Density")
}
if(!xlabs){
temp <- temp + theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.ticks.x = element_blank())
}
return(temp)
}
#construct subpanels for plots
bounds <- c(-5, 5)
innov_prob <- plot_constructor(posterior_predictions$innov_prob, xlim = c(0, 1), xlabel = "Innovation Probability", color = "red")
innov_x_times <- plot_constructor(posterior_predictions$innov_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "red")
innov_x_pop <- plot_constructor(posterior_predictions$innov_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Innovation", color = "red")
innov_x_year <- plot_constructor(posterior_predictions$innov_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "red")
learn_prob <- plot_constructor(posterior_predictions$learn_prob, xlim = c(0, 1), xlabel = "Copying Probability", color = "blue")
learn_x_times <- plot_constructor(posterior_predictions$learn_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "blue")
learn_x_pop <- plot_constructor(posterior_predictions$learn_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Copying", color = "blue")
learn_x_year <- plot_constructor(posterior_predictions$learn_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "blue")
#improve_rate_m <- plot_constructor(posterior_predictions$improve_rate_m, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Men)")
#improve_rate_w <- plot_constructor(posterior_predictions$improve_rate_w, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Women)")
#set theme for cowplot
theme_set(theme_cowplot(font_family = font))
#combined and save panels
png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
#also save as eps
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = font, type = "EPS"
)
#load libraries for plotting
library(ggplot2)
library(cowplot)
library(grid)
#set font family
font = "Myriad Pro Condensed"
#create function for constructing plots
plot_constructor <- function(post, tol = 1000, xlim, bound = 0.001, two_axes = TRUE, xlabel = NULL, ylabel = NULL, xlabs = TRUE, ybuffer = 0.02, small = FALSE, font_size = 6, color){
post <- density(post, from = xlim[1], to = xlim[2], bw = "SJ", kernel = "gaussian")
plot_data <- data.frame(x = c(post$x), y = c(post$y))
if(length(which(post$y < bound) > 0)){plot_data$y[which(plot_data$y < bound)] <- NA}
temp <- ggplot(plot_data, aes(x, y)) + geom_line(aes(y = y), color = color) +
geom_segment(x = plot_data$x[which.max(plot_data$y)], xend = plot_data$x[which.max(plot_data$y)],
y = plot_data$y[which.max(plot_data$y)], yend = 0, color = color, linetype = "solid") +
xlim(xlim[1], xlim[2]) + xlab(xlabel) + ylab("Density") + theme_linedraw(base_size = font_size) +
scale_y_continuous(expand = c(0, 0), limits = c(0, max(plot_data$y, na.rm = TRUE) + max(plot_data$y, na.rm = TRUE)*ybuffer)) +
theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), text = element_text(family = font))
if(small){
temp <- temp +
theme(axis.text.y = element_blank()) +
geom_vline(xintercept = 0, linetype = "dotted", size = 0.5) +
annotation_custom(
grob = textGrob(ylabel,
x = 0.01, y = 0.78,
hjust = 0,
gp = gpar(fontsize = 6, fontfamily = font))
) +
ylab("Density")
}
if(!xlabs){
temp <- temp + theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.ticks.x = element_blank())
}
return(temp)
}
#construct subpanels for plots
bounds <- c(-5, 5)
innov_prob <- plot_constructor(posterior_predictions$innov_prob, xlim = c(0, 1), xlabel = "Innovation Probability", color = "red")
innov_x_times <- plot_constructor(posterior_predictions$innov_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "red")
innov_x_pop <- plot_constructor(posterior_predictions$innov_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Innovation", color = "red")
innov_x_year <- plot_constructor(posterior_predictions$innov_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "red")
learn_prob <- plot_constructor(posterior_predictions$learn_prob, xlim = c(0, 1), xlabel = "Copying Probability", color = "blue")
learn_x_times <- plot_constructor(posterior_predictions$learn_x_times, xlim = bounds, small = TRUE, ylabel = "Current Record", color = "blue")
learn_x_pop <- plot_constructor(posterior_predictions$learn_x_pop, xlim = bounds, small = TRUE, ylabel = "Population Size", xlabel = "Effect on Copying", color = "blue")
learn_x_year <- plot_constructor(posterior_predictions$learn_x_year, xlim = bounds, small = TRUE, ylabel = "Time Trend", color = "blue")
#improve_rate_m <- plot_constructor(posterior_predictions$improve_rate_m, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Men)")
#improve_rate_w <- plot_constructor(posterior_predictions$improve_rate_w, xlim = c(1, 3), xlabel = "Rate of Athletic Improvement (Women)")
#set theme for cowplot
theme_set(theme_cowplot(font_family = font))
#combined and save panels
png("analysis/data_and_output/05_posterior_processing/posterior_distributions.png", units = "in", width = 7.2, height = 3, res = 1000)
space <- plot_grid(NULL)
innov_interactions <- plot_grid(innov_x_year, innov_x_times, innov_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
first_row <- plot_grid(space, innov_prob, innov_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
learn_interactions <- plot_grid(learn_x_year, learn_x_times, learn_x_pop, ncol = 1, rel_heights = c(1, 1, 1.2))
second_row <- plot_grid(space, learn_prob, learn_interactions, nrow = 1, rel_widths = c(0.02, 1, 1))
#third_row <- plot_grid(space, improve_rate_m, improve_rate_w, nrow = 1, rel_widths = c(0.02, 1, 1))
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6))
#plot_grid(first_row, space, second_row, space, third_row, ncol = 1, labels = c("A", "", "B", "", "C"), rel_heights = c(0.6, 0.02, 0.6, 0.02, 0.6))
dev.off()
#also save as eps
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = font, type = "EPS"
)
#also save as eps
export::graph2vector(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = "Myriad Pro Condensed", type = "EPS"
)
#also save as eps
export::graph2eps(
plot_grid(first_row, space, second_row, ncol = 1, labels = c("A", "", "B"), rel_heights = c(0.6, 0.02, 0.6)),
file = "analysis/data_and_output/05_posterior_processing/posterior_distributions.eps",
width = 7.2, height = 3, font = font
)
extrafont::font_import(font)
extrafont::font_ttf("~/Downloads/myriad-pro-condensed.ttf")
extrafont::font_import("~/Downloads/myriad-pro-condensed.ttf")
extrafont::font_import()
extrafont::loadfonts(device = "postscript")
fonts <- extrafont::fonts()
grep("Myriad", fonts, value = TRUE)
