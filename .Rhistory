from = 0, to = 0.1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_vline(intercept = post_m$x[which.max(post_m$y)], color = "blue") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
theme_linedraw() + theme(legend.position = "none")
?geom_vline
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_vline(xintercept = post_m$x[which.max(post_m$y)], color = "blue") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
theme_linedraw() + theme(legend.position = "none")
?geom_vline
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], xend = 0, color = "blue") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "blue") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
theme_linedraw() + theme(legend.position = "none")
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("red", length(post_m$x)), rep("blue", length(post_w$x))))
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("blue", "red")) +
theme_linedraw() + theme(legend.position = "none")
post_m <- density(params_m_100$innov_prob[order(results_m_100)[1:100]],
from = 0, to = 0.1)
post_w <- density(params_w_100$innov_prob[order(results_w_100)[1:100]],
from = 0, to = 0.1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep(0, length(post_m$x)), rep(1, length(post_w$x))))
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("blue", "red")) +
theme_linedraw() + theme(legend.position = "none")
post_m <- density(params_m_100$innov_prob[order(results_m_100)[1:100]],
from = 0, to = 0.1)
post_w <- density(params_w_100$innov_prob[order(results_w_100)[1:100]],
from = 0, to = 0.1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("blue", "red")) +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
post_m <- density(params_m_100$innov_prob[order(results_m_100)[1:100]],
from = 0, to = 0.1)
post_w <- density(params_w_100$innov_prob[order(results_w_100)[1:100]],
from = 0, to = 0.1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", aes(linetype = "dotted")) +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", aes(linetype = "dotted")) +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
ls()
grep("results_m", ls())
ls()[grep("results_m", ls())]
post_m <- density(params_m_100$innov_prob[order(results_m_100)[1:100]],
from = 0, to = 0.1)
post_w <- density(params_w_100$innov_prob[order(results_w_100)[1:100]],
from = 0, to = 0.1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
innov_prob_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0, 0.05) + xlab("Innovation Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
rm(list = c("post_m", "post_w", "plot_data"))
innov_prob_plot
post_m <- density(params_m_100$learn_prob[order(results_m_100)[1:100]],
from = 0, to = 0.1)
post_w <- density(params_w_100$learn_prob[order(results_w_100)[1:100]],
from = 0, to = 0.1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
learn_prob_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0.5, 1) + xlab("Learn Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
learn_prob_plot
post_m
plot(post_m)
params_m_100
params_m_100$learn_prob
post_m <- density(params_m_100$learn_prob[order(results_m_100)[1:100]],
from = 0.5, to = 1)
post_w <- density(params_w_100$learn_prob[order(results_w_100)[1:100]],
from = 0.5, to = 1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
learn_prob_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0.5, 1) + xlab("Learn Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
post_m <- density(params_m_100$learn_prob[order(results_m_100)[1:100]],
from = 0.5, to = 1)
post_w <- density(params_w_100$learn_prob[order(results_w_100)[1:100]],
from = 0.5, to = 1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
learn_prob_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0.5, 1) + xlab("Learn Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
learn_prob_plot
post_m <- density(params_m_100$learn_prob[order(results_m_100)[1:100]],
from = 0.5, to = 1)
post_w <- density(params_w_100$learn_prob[order(results_w_100)[1:100]],
from = 0.5, to = 1)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
learn_prob_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0.5, 1) + xlab("Learn Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
learn_prob_plot
rm(list = c("post_m", "post_w", "plot_data"))
post_m <- density(params_m_100$n_top[order(results_m_100)[1:100]],
from = 1, to = 34)
post_w <- density(params_w_100$n_top[order(results_w_100)[1:100]],
from = 1, to = 34)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
n_top_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(1, 34) + xlab("Learn Probability") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
n_top_plot
n_top_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(1, 34) + xlab("N Top for Learning") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
n_top_plot
post_m <- density(params_m_100$n_top[order(results_m_100)[1:100]],
from = 1, to = 34)
post_w <- density(params_w_100$n_top[order(results_w_100)[1:100]],
from = 1, to = 34)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
n_top_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(1, 34) + xlab("N Top") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
n_top_plot
post_m <- density(params_m_100$n_top[order(results_m_100)[1:100]],
from = 4, to = 28)
post_w <- density(params_w_100$n_top[order(results_w_100)[1:100]],
from = 4, to = 28)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
n_top_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(4, 28) + xlab("N Top") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
n_top_plot
post_m <- density(params_m_100$n_top[order(results_m_100)[1:100]],
from = 2, to = 28)
post_w <- density(params_w_100$n_top[order(results_w_100)[1:100]],
from = 2, to = 28)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
n_top_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(2, 28) + xlab("N Top") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
n_top_plot
rm(list = c("post_m", "post_w", "plot_data"))
post_m <- density(params_m_100$adj_poss[order(results_m_100)[1:100]],
from = 1, to = 2)
post_w <- density(params_w_100$adj_poss[order(results_w_100)[1:100]],
from = 1, to = 2)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
adj_poss_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(1, 2) + xlab("Adjacent Possible") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
adj_poss_plot
post_m <- density(params_m_100$improve_rate_m[order(results_m_100)[1:100]],
from = 1, to = 3)
post_w <- density(params_w_100$improve_rate_m[order(results_w_100)[1:100]],
from = 1, to = 3)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
improve_rate_m_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(1, 3) + xlab("Improvement Rate (M)") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
improve_rate_m_plot
post_m <- density(params_m_100$improve_rate_m[order(results_m_100)[1:100]],
from = 1.8, to = 2.2)
post_w <- density(params_w_100$improve_rate_m[order(results_w_100)[1:100]],
from = 1.8, to = 2.2)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
improve_rate_m_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(1.8, 2.2) + xlab("Improvement Rate (M)") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
improve_rate_m_plot
post_m <- density(params_m_100$improve_rate_m[order(results_m_100)[1:100]],
from = 1.8, to = 2.05)
post_w <- density(params_w_100$improve_rate_m[order(results_w_100)[1:100]],
from = 1.8, to = 2.05)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
improve_rate_m_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(1.8, 2.05) + xlab("Improvement Rate (M)") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
improve_rate_m_plot
post_m <- density(params_m_100$improve_rate_sd[order(results_m_100)[1:100]],
from = 0, to = 0.3)
post_w <- density(params_w_100$improve_rate_sd[order(results_w_100)[1:100]],
from = 0, to = 0.3)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
improve_rate_sd_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0, 0.3) + xlab("Improvement Rate (SD)") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
improve_rate_sd_plot
post_m <- density(params_m_100$improve_rate_sd[order(results_m_100)[1:100]],
from = 0.05, to = 0.3)
post_w <- density(params_w_100$improve_rate_sd[order(results_w_100)[1:100]],
from = 0.05, to = 0.3)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
improve_rate_sd_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0.05, 0.3) + xlab("Improvement Rate (SD)") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
improve_rate_sd_plot
post_m <- density(params_m_100$improve_min[order(results_m_100)[1:100]],
from = 0.1, to = 0.4)
post_w <- density(params_w_100$improve_min[order(results_w_100)[1:100]],
from = 0.1, to = 0.4)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
improve_min_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0.1, 0.4) + xlab("Minimum Improvement") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
improve_min_plot
post_m <- density(params_m_100$improve_min[order(results_m_100)[1:100]],
from = 0.2, to = 0.28)
post_w <- density(params_w_100$improve_min[order(results_w_100)[1:100]],
from = 0.2, to = 0.28)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
improve_min_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0.2, 0.28) + xlab("Minimum Improvement") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
improve_min_plot
post_m <- density(params_m_100$improve_min[order(results_m_100)[1:100]],
from = 0.2, to = 0.28)
post_w <- density(params_w_100$improve_min[order(results_w_100)[1:100]],
from = 0.2, to = 0.28)
plot_data <- data.frame(x = c(post_m$x, post_w$x), y = c(post_m$y, post_w$y), group = c(rep("m", length(post_m$x)), rep("w", length(post_w$x))))
improve_min_plot <- ggplot(plot_data, aes(x, y)) + geom_line(aes(color = group)) +
geom_segment(x = post_m$x[which.max(post_m$y)], xend = post_m$x[which.max(post_m$y)],
y = post_m$y[which.max(post_m$y)], yend = 0, color = "red", linetype = "dotted") +
geom_segment(x = post_w$x[which.max(post_w$y)], xend = post_w$x[which.max(post_w$y)],
y = post_w$y[which.max(post_w$y)], yend = 0, color = "blue", linetype = "dotted") +
xlim(0.2, 0.28) + xlab("Minimum Improvement") + ylab("Density") +
scale_color_manual(values = c("red", "blue")) +
theme_linedraw() + theme(legend.position = "none")
improve_min_plot
rm(list = c("post_m", "post_w", "plot_data"))
cowplot::plot_grid(innov_prob_plot, learn_prob_plot, n_top, adj_poss)
cowplot::plot_grid(innov_prob_plot, learn_prob_plot, n_top_plot, adj_poss_plot)
cowplot::plot_grid(innov_prob_plot, learn_prob_plot, n_top_plot, adj_poss_plot, labels = c("A", "B", "C", "D"))
cowplot::plot_grid(improve_rate_m_plot, improve_rate_sd_plot, improve_min_plot, labels = c("A", "B", "C", "D"))
10000*0.01
50000*0.005
50000*0.001
50000*0.002
setwd("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM")
#random seed
set.seed(12345)
#subset data to only include men
data <- data[which(data$gender == "W"), ]
#get all unique climbers
uniq_climbers <- unique(data$athlete)
#separate continuous sequences of years
seqs <- lapply(uniq_climbers, function(x){split(data$year[which(data$athlete == x)], cumsum(seq_along(data$year[which(data$athlete == x)]) %in% (which(diff(data$year[which(data$athlete == x)]) > 1) + 1)))})
#for each unique climber, iterate through their sequences, and and extract their ID, start year, end year, and time in start year (separate row per sequence)
pop_data <- data.table::data.table(do.call(rbind, lapply(1:length(uniq_climbers), function(i){
t(sapply(1:length(seqs[[i]]), function(j){
c(uniq_climbers[i], min(unlist(seqs[[i]][j])), max(unlist(seqs[[i]][j])), data$time[which(data$athlete == uniq_climbers[i] & data$year == min(unlist(seqs[[i]][j])))])
}))
})))
colnames(pop_data) <- c("ID", "start", "end", "time")
pop_data
#get years
years <- sort(unique(data$year))
#get population sizes
n <- unlist(lapply(1:length(years), function(x){nrow(data[which(data$year == years[x]), ])}))
#get observed summary statistics
obs_stats <- lapply(years, function(x){sort(data$time[which(data$year == x)])})
load("data.RData")
source("SpeedClimbingABM.R")
#random seed
set.seed(12345)
#subset data to only include men
data <- data[which(data$gender == "W"), ]
#get all unique climbers
uniq_climbers <- unique(data$athlete)
#separate continuous sequences of years
seqs <- lapply(uniq_climbers, function(x){split(data$year[which(data$athlete == x)], cumsum(seq_along(data$year[which(data$athlete == x)]) %in% (which(diff(data$year[which(data$athlete == x)]) > 1) + 1)))})
#for each unique climber, iterate through their sequences, and and extract their ID, start year, end year, and time in start year (separate row per sequence)
pop_data <- data.table::data.table(do.call(rbind, lapply(1:length(uniq_climbers), function(i){
t(sapply(1:length(seqs[[i]]), function(j){
c(uniq_climbers[i], min(unlist(seqs[[i]][j])), max(unlist(seqs[[i]][j])), data$time[which(data$athlete == uniq_climbers[i] & data$year == min(unlist(seqs[[i]][j])))])
}))
})))
colnames(pop_data) <- c("ID", "start", "end", "time")
pop_data
#get years
years <- sort(unique(data$year))
#get population sizes
n <- unlist(lapply(1:length(years), function(x){nrow(data[which(data$year == years[x]), ])}))
#get observed summary statistics
obs_stats <- lapply(years, function(x){sort(data$time[which(data$year == x)])})
obs_stats
c(obs_stats)
unlist(obs_stats)
obs_stats
unlist(obs_stats)
obs_stats[[1]]
obs_stats[[2]]
unlist(obs_stats[1:2])
obs_stats[-1]
unlist(obs_stats[-1])
sqrt(sum((a-b)^2))
#euclidean distance function where a and b are the unlisted vectors of times
euclidean <- function(a, b){
return(sqrt(sum((a-b)^2)))
}
euclidean(unlist(obs_stats[-1]), unlist(obs_stats[-1])+1)
euclidean(unlist(obs_stats[-1]), unlist(obs_stats[-1])+2)
euclidean(unlist(obs_stats[-1]), unlist(obs_stats[-1])+3)
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$innov_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$innov_prob))
plot(density(params_nuuu$learn_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$learn_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$learn_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$learn_prob))
plot(density(params_nuuu$innov_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$innov_prob))
plot(density(params_nuuu$learn_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$learn_prob))
plot(density(params_nuuu$innov_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$innov_prob))
plot(density(params_nuuu$learn_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$learn_prob))
plot(density(params_nuuu$innov_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$innov_prob))
plot(density(params_nuuu$learn_prob))
plot(density(params_nuuu$innov_prob))
plot(density(params_nuuu$learn_prob))
plot(density(params_nuuu$n_top))
plot(density(params_nuuu$adj_poss))
plot(density(params_nuuu$improve_rate_m))
plot(density(params_nuuu$improve_rate_sd))
plot(density(params_nuuu$improve_min))
plot(density(params_nuuu$adj_poss))
plot(density(params_nuuu$innov_prob))
plot(density(params_nuuu$learn_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$learn_prob))
plot(density(params_nuuu$innov_prob))
plot(density(params_nuuu$n_top))
plot(density(params_nuuu$improve_rate_m))
plot(density(params_nuuu$improve_rate_sd))
plot(density(params_nuuu$improve_min))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$innov_prob))
plot(density(params_nuuu$learn_prob))
params_nuuu <- readRDS("~/Documents/Work/Summer_2021/Speed Climbing/SpeedClimbingABM/hpcc_output/params.RDS")
plot(density(params_nuuu$learn_prob))
plot(density(params_nuuu$innov_prob))
